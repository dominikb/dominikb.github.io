{"componentChunkName":"component---src-templates-tag-js","path":"/tags/laravel/","result":{"data":{"site":{"siteMetadata":{"title":"Dominik Bauernfeind","author":"Dominik Bauernfeind","labels":[{"tag":"laravel","tech":"Laravel","name":"DiLaravel","size":20,"color":"#ff2c1f"},{"tag":"php","tech":"PHP","name":"DiPhp","size":20,"color":"#8892bf"},{"tag":"gitlab","tech":"Gitlab","name":"FaGitlab","size":20,"color":"#fc6d25"},{"tag":"cicd","tech":"CI/CD","name":"DiTerminal","size":20,"color":null},{"tag":"ruby","tech":"Ruby","name":"DiRuby","size":20,"color":"#aa1401"},{"tag":"rails","tech":"Rails","name":"SiRubyonrails","size":20,"color":"#d30001"},{"tag":"java","tech":"Java","name":"FaJava","size":20,"color":"#df0000"},{"tag":"spring","tech":"Spring","name":"SiSpring","size":20,"color":"#6db33f"},{"tag":"spring-boot","tech":"Spring Boot","name":"SiSpringboot","size":20,"color":"#6db33f"}]}},"allMarkdownRemark":{"totalCount":2,"edges":[{"node":{"excerpt":"During the last few months, I’ve read a lot of blog posts and guides that talk about the benefits and joys of TDD. Although they all were credible sources and I believed the points they made about all…","html":"<p>During the last few months, I’ve read a lot of blog posts and guides that talk about the benefits and joys of TDD.</p>\n<p>Although they all were credible sources and I believed the points they made about all the benefits you get when applying this style of development, I just could not quite get myself to try it out.</p>\n<p>The biggest hurdle for me seemed, that there were no clear instructions on how to get started.</p>\n<h2>My problem with Test Driven Development</h2>\n<p>How development works, how I have been taught and taught myself to write code, always followed a simple pattern:</p>\n<ul>\n<li>You grasp the existing problem and think of a solution</li>\n<li>You abstract the solution into a flow and break it down to smaller steps</li>\n<li>You implement those steps in code</li>\n</ul>\n<p>Of course, you should always follow the best practices of loose coupling or the use of common patterns, but there simply was no room within this process to test the implemented solution.</p>\n<p>And I was pretty confident with this workflow, properly planning ahead my tasks and implementing one small, comprehensible step at a time, in order for the software that I was producing to be of decent quality.</p>\n<p>It always seemed pretty intimidating to start with automated testing. There is so much to know about programming already, I can’t probably learn everything there is to learn about testing as well.</p>\n<p>How do I set up testing at all? What do I test for? What can I do if my implementation uses another class’ function? How do I even prepare the state of my application that I would need, to test a specific scenario?</p>\n<p>This is too much, surely I’m fine without this, I thought.</p>\n<p>Boy, was I wrong.</p>\n<h2>Getting a hold of TDD</h2>\n<p>A few weeks ago I was purchasing something from Amazon when I got the suggestion for a book: The Clean Coder. I took a look into the books reviews and although the book’s quite pricey and has aged somewhat, I rather quickly decided to get a hard copy and give it a try.</p>\n<p>Let me tell you, this book is well worth its cost!</p>\n<p>It goes into depth about what it means to be a professional programmer and how much farther our responsibility extends than just towards our code.</p>\n<h3>Chapter 5 — Test Driven Development</h3>\n<p>After being hooked by the first chapter, I seemingly devoured the book until I’ve reached chapter 5. There it was, the ubiquitous topic of testing.\nAnd this time I decided to give it a try for real.</p>\n</hr>\n<h2>First Steps</h2>\n<p>Most of the examples that were given to me about TDD, were applications that already had high a good amount of tests. But where would I start with my applications, that have had no tests at all?</p>\n<p>The plain and simple answer to this is: Anywhere!</p>\n<h3>Any tests are better than no tests</h3>\n<p>The hurdle of you writing your first test is not as big of a challenge as it might seem. You must not strive for 100% coverage or perfect tests, as they are an ever-evolving part of your code base.</p>\n<p>They too can be refactored and improved at a later stage, the key is just getting started.</p>\n<h2>My first test</h2>\n<p>There is no secret to testing, but to start small. The value of your tests will accumulate on its own and at some point provide great value to your code base.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span>Eloquent<span class=\"token punctuation\">\\</span>Model</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * @return string\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getFullNameAttribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">first_name</span></span> <span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">last_name</span></span>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>Our first goal is to test this existing class. Assuming we have not yet set up any tests and this code is already implemented.\nSimply run <code class=\"language-text\">php artisan make:test UserTest --unit</code> to create a test stub for you and this is what you will end up with.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>Unit</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>TestCase</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">UserTest</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TestCase</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * A basic test example.\n     *\n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">testExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>What we now want is to test, that our <code class=\"language-text\">getFullNameAttribute()</code> method indeed concatenates the first name and last name of our user to build the full name.</p>\n<p>Our first implementation of the test could look like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>Unit</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>User</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>TestCase</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">UserTest</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TestCase</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/** @test */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">it_concatenates_first_and_last_name_to_build_the_full_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token property\">first_name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"John\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token property\">last_name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"Doe\"</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>\n            <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">getFullNameAttribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"John Doe\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The <code class=\"language-text\">@test</code> annotation describes to the underlying PhpUnit testing framework, that this function is a test.</p>\n<p>We specified a descriptive name for our method and built the state we require to make an assertion about our code. At a later point, we could refactor this to use <a href=\"https://laravel.com/docs/5.7/seeding\">Laravels model factories</a>, but as of now, this will suffice.</p>\n<p>If we run the code by executing PhpUnit from the command line <code class=\"language-text\">vendor/bin/phpunit</code> we should see all tests passing.</p>\n<p>To validate our test, change the first name to <code class=\"language-text\">Jane</code> and re-execute the test. It should now fail.</p>\n<h2>This was easy, what now?</h2>\n<p>Testing methods on classes, that do not require interaction with the outside world, is pretty straightforward. If, however, we would need to ask a service for a potential nickname of our user, this changes.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span>Eloquent<span class=\"token punctuation\">\\</span>Model</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * @return string\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getFullNameAttribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$nickName</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">NicknameService</span><span class=\"token operator\">::</span><span class=\"token function\">getNickname</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">first_name</span></span> <span class=\"token interpolation\"><span class=\"token variable\">$nickName</span></span> <span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">last_name</span></span>\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">first_name</span></span> <span class=\"token interpolation\"><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">last_name</span></span>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>In order not to depend on the implementation of the NicknameService, we need to “mock” it. This means that we intercept the call to the service and return a static result.</p>\n<p>(This makes use of Laravel Facades, you can learn more about them <a href=\"https://laravel.com/docs/5.7/facades\">here</a>.)</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>Unit</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>User</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Tests<span class=\"token punctuation\">\\</span>TestCase</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">UserTest</span>\n    <span class=\"token keyword\">extends</span> <span class=\"token class-name\">TestCase</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token comment\">// first test ...</span>\n\n    <span class=\"token comment\">/** @test */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">it_puts_the_nickname_between_first_and_last_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token property\">first_name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"John\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token property\">last_name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"Doe\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name static-context\">NicknameService</span><span class=\"token operator\">::</span><span class=\"token function\">shouldReceive</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'getNickname'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">once</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">andReturn</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"'The Outlaw'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                  \n        \n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>\n            <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">getFullNameAttribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"John 'The Outlaw' Doe\"</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>What this test does should be pretty self-explanatory. By using a Facade we make it really easy to “mock” the result of the function and decouple it from the specific implementation of the actual Nickname service.</p>\n<p>Combined with factories and great helper methods, this makes for a really pleasant testing experience.</p>\n<h2>Reaping the benefits</h2>\n<p>If learning the practices of testing seems like overhead, you will quickly realize, that using a testing framework will remove a lot of manual testing and actually be a huge time saver.</p>\n<p>Furthermore, once the time was invested to implement a test, it can be re-run in the future without any effort, giving you the benefit of being sure, that your changes did not break the tested functionality.</p>\n<p>If you’ve always wanted to contribute to open source, but did not know how or where intimidated, that any contribution required tests to go along with it, you can now confidently go ahead and implement your feature with ease.</p>\n<p>In short, testing your code will give you a huge confidence boost in your code. Mistakes will still happen, we are human after all, but they will be much rarer and easier to track down.</p>\n<h2>Next Steps</h2>\n<p>As already mentioned, there is a lot to learn about testing. So go ahead and pick up a book, an online course or just read through the documentation of Laravel and PhpUnit.</p>\n<p>I can personally recommend Laracasts course on <a href=\"https://laracasts.com/series/phpunit-testing-in-laravel\">Testing Laravel</a>. Jeffrey Wey does a great job explaining TDD in more detail and gives useful tips that will make you better at testing immediately.</p>\n<p>When implementing new features, write tests, that describe your implementation, before actually implementing the functionality.</p>\n<h3>Links</h3>\n<ul>\n<li><a href=\"https://laravel.com/docs/5.7/testing\">https://laravel.com/docs/5.7/testing</a></li>\n<li><a href=\"https://phpunit.de/\">https://phpunit.de/</a></li>\n</ul>","id":"46b0b51b-481c-5db7-9435-e18d5cbd7ff7","frontmatter":{"title":"Getting started with Test Driven Development in Laravel","date":"December, 2018","tags":["laravel","php"],"excerpt":null},"fields":{"slug":"/2018-12-getting-started-with-test-driven-development-in-laravel/"}}},{"node":{"excerpt":"Lately, I have been developing an application based on Laravel 5.7 that makes heavy use of Laravels Queue feature. In order to easier structure different debug information for multiple hosts we use…","html":"<p>Lately, I have been developing an application based on Laravel 5.7 that makes heavy use of Laravels Queue feature.</p>\n<p>In order to easier structure different debug information for multiple hosts we use Elastic Logstash and Kibana.</p>\n<p>Laravel does not come with a pre-configured Logstash driver option, but I got it up and running with very little work.</p>\n<h2>Logstash Driver</h2>\n<p>Laravels logging configuration is placed within the <code class=\"language-text\">config/logging.php</code> file. In order to add our configuration for Logstash, we simply add a custom provider.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ... other configuration stuff</span>\n\n    <span class=\"token string single-quoted-string\">'channels'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n        <span class=\"token comment\">// ... other channels like stack or single</span>\n\n        <span class=\"token string single-quoted-string\">'logstash'</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string single-quoted-string\">'driver'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'custom'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'via'</span>    <span class=\"token operator\">=></span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>App<span class=\"token punctuation\">\\</span>LogstashLogger</span><span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'host'</span>   <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'LOGSTASH_HOST'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'127.0.0.1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string single-quoted-string\">'port'</span>   <span class=\"token operator\">=></span> <span class=\"token function\">env</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'LOGSTASH_PORT'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4718</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>For more on how to define custom loggers, refer to the <a href=\"https://laravel.com/docs/5.7/logging#creating-channels-via-factories\">Laravel documentation</a>.</p>\n<h2>Logstash Logger Provider</h2>\n<p>So what does our factory class do? All it needs to do is to implement PHPs magic method <code class=\"language-text\">__invoke()</code> and return an instance of <code class=\"language-text\">\\Psr\\Log\\LoggerInterface</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Monolog<span class=\"token punctuation\">\\</span>Formatter<span class=\"token punctuation\">\\</span>LogstashFormatter</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Monolog<span class=\"token punctuation\">\\</span>Handler<span class=\"token punctuation\">\\</span>SocketHandler</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Monolog<span class=\"token punctuation\">\\</span>Logger</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Psr<span class=\"token punctuation\">\\</span>Log<span class=\"token punctuation\">\\</span>LoggerInterface</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">LogstashLogger</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">/**\n     * @param array $config\n     * @return LoggerInterface\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$config</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token class-name return-type\">LoggerInterface</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$handler</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SocketHandler</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"udp://<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$config</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'host'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>:<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$config</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'port'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$handler</span><span class=\"token operator\">-></span><span class=\"token function\">setFormatter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">LogstashFormatter</span><span class=\"token punctuation\">(</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'app.name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Logger</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'logstash.main'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token variable\">$handler</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n</br>\n<h2>… and done!</h2>\n<p>Now you are ready to use the custom channel to ship your logs via UDP to any Logstash Host that accepts data on the specified port.</p>\n<p>To use the new configuration add it to a logging channel of type <code class=\"language-text\">'stack'</code> or make use of it directly: <code class=\"language-text\">Log::channel('logstash')->debug('Logging to logstash');</code></p>","id":"317989a9-e64d-57eb-bf99-697442b47b06","frontmatter":{"title":"Using Logstash with Laravel","date":"November, 2018","tags":["laravel","php"],"excerpt":null},"fields":{"slug":"/2018-11-using-logstash-with-laravel/"}}}]}},"pageContext":{"tag":"laravel"}},"staticQueryHashes":["2212750296","2457483284","3019618709","63159454"]}