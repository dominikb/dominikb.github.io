{"componentChunkName":"component---src-templates-blog-post-js","path":"/2022-03-04-rails-eager-loading-all-files/","result":{"data":{"site":{"siteMetadata":{"url":"https://dominikb.io","title":"Dominik Bauernfeind","labels":[{"tag":"laravel","tech":"Laravel","name":"DiLaravel","size":20,"color":"#ff2c1f"},{"tag":"php","tech":"PHP","name":"DiPhp","size":20,"color":"#8892bf"},{"tag":"gitlab","tech":"Gitlab","name":"FaGitlab","size":20,"color":"#fc6d25"},{"tag":"cicd","tech":"CI/CD","name":"DiTerminal","size":20,"color":null},{"tag":"ruby","tech":"Ruby","name":"DiRuby","size":20,"color":"#aa1401"},{"tag":"rails","tech":"Rails","name":"SiRubyonrails","size":20,"color":"#d30001"},{"tag":"java","tech":"Java","name":"FaJava","size":20,"color":"#df0000"},{"tag":"spring","tech":"Spring","name":"SiSpring","size":20,"color":"#6db33f"},{"tag":"spring-boot","tech":"Spring Boot","name":"SiSpringboot","size":20,"color":"#6db33f"}]}},"markdownRemark":{"html":"<p>Once, I wrote some code that read similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">module</span> <span class=\"token class-name\">Stub</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">Applicable</span> <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">ImmediatelyApplicable</span> <span class=\"token operator\">&lt;</span> Applicable\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">DelayedApplicable</span> <span class=\"token operator\">&lt;</span> Applicalbe\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>As this were just stub-classes they were not used in any test. They pipeline succeeded and deployed the code to a staging environment. This resulted in an error and the service was down, albeit working perfectly on my machine! </p>\n<blockquote>\n<p><strong>[2022-03-04T12:34:56+00.00 app[worker.1]: pid=1 tid=2ks]</strong> WARN: NameError: uninitialized constant Stub::Applicalbe</p>\n</blockquote>\n<p>Turns out, I made a typo and wrote <em>Applica<strong>lb</strong>e</em>. *facepalm*</p>\n<p>When in development mode, files are only required when they are needed the first time but when running <code class=\"language-text\">Rails</code> in production mode, it was eager loading all the files.</p>\n<p>Turns out, you can reproduce this locally in your console to re-create the error:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ bin/rails console\nirb(main):001:0&gt; Rails.application.eager_load!</code></pre></div>","frontmatter":{"title":"How to eager load files with Rails","date":"March 04, 2022","tags":["rails","ruby"]}}},"pageContext":{"slug":"/2022-03-04-rails-eager-loading-all-files/"}},"staticQueryHashes":["2212750296","2457483284","3019618709","63159454"]}